<html><title>Infernal Throne</title><link rel="shortcut icon" type="image/x-icon" sizes="64x64"/><style>canvas{width:100%;}body{overflow:none;background:#000;margin:0px;}</style><canvas/><script>var n={};function a0(t,e){(n[t]||(n[t]=[])).push(e)}function r0(t,e){n[t]=(n[t]||[]).filter(t=>t!=e)}function o0(t,e){(n[t]||[]).map(t=>t(e))}var R=[["#e22",9,0],[14,-40,18,-26,1,0,-1,0,-18,-26,-14,-40],[-7,-11,7,-11],["#fff",4,5],[-9,-11,-3,-9],[9,-11,3,-9]],g=[["#fff",6,0],[-11,-7,-7,-7,7,7,7,11],[-7,-11,-7,-7,7,7,11,7]],v=[[["#4af",2,0],[10,-12,15,12,-15,12,0,0,-10,0]],[["#4af",2,0],[10,-15,-10,-7,10,0,-10,7,10,15]],[["#4af",2,0],[0,-18,0,-5,12,0,0,12,-12,0]],[["#4af",2,0],[-15,-11,-15,11,0,11,0,-11,15,-11,15,11]],[["#4af",2,0],[0,-15,10,0,0,15,-10,0,0,-15]]],M=["The Crossroads","Undergrowth","Boneyard Caverns","Fields of Mourning","Throne Room"],y=document.getElementsByTagName("canvas")[0],w=(y.width=window.innerWidth,y.height=window.innerHeight*y.width/window.innerWidth,y.getContext("2d"));function i0(t,e){w.strokeStyle=t,w.fillStyle=e||t}function U(t,e,n,a){w.translate(e,n),w.scale(t,a||t),w.translate(-e,-n)}function h0(e,t,n,a,r,o,i=null){var h=w.getTransform(),s=(w.translate(t,n),w.rotate(o),Math.cos(r)),f=Math.sin(r);let l=a;for(let t=0;t<e.length;t++){var u=e[t];if(3==u.length)i0(u[0],i||u[0]),w.lineWidth=u[1],l=a+u[2];else{w.beginPath(),w.moveTo(u[0]*s-l*f,u[1]);for(let t=2;t<u.length;t+=2)w.lineTo(u[t]*s-l*f,u[t+1]);i&&w.fill(),w.stroke()}}w.setTransform(h)}function m(t,e,n,a="#fff",r=30,o="left"){w.fillStyle=a,w.textAlign=o,w.font=`bold ${r}px arial`,w.fillText(t,e,n)}var b=y.width,T=y.height,i=(y.width=64,y.height=64,w.fillStyle="rgba(0,0,0,0)",w.fillRect(0,0,64,64),h0(R,32,48,0,0,0),document.querySelector("link[rel~='icon']").href=y.toDataURL(),y.width=b,y.height=T,w.textBaseline="middle",w.lineJoin="round",w.lineCap="round",[]),a={},h=[],V=0;function q(t){let e=Math.min(.001*(t-V),.018);w.clearRect(0,0,y.width,y.height);var n=w.getTransform();let a=s0("camera")[0],r=a.getX(),o=a.getY();a.set(w),h.length=0,i.map(t=>{t.update?.(e)&&h.push(t)}),h.length&&p(h),i.map(t=>{t.inView(r,o)&&t.render?.(w)}),requestAnimationFrame(q),V=t,w.setTransform(n)}function x(e){e.inView||(e.inView=()=>1),i.push(e),i.sort((t,e)=>(t.order||0)-(e.order||0)),e.tags?.map(t=>{a[t]=a[t]??[],a[t].push(e)}),e.enable?.()}function S(t,e){return t.filter(t=>!e.includes(t))}function p(t){i=S(i,t),t.map(e=>{e.tags?.map(t=>{a[t]=S(a[t],[e])}),e.disable?.()})}function s0(t){return a[t]||[]}function W(t,e,n){return Math.max(Math.min(t,n),e)}function f0(t){return JSON.parse(JSON.stringify(t))}function N(t,e,n,a){return!(n+1e3<t||a+700<e||t<n-1e3||e<a-700)}var e=[0,0,!1,!1,!1,!1];function l0(t,n){let a=n.x,r=n.y,o=!1,i=!1,h=!1,s=!1;return t.map(({physics:e})=>{if(n.isTouching(e)){let t=!1;r+n.oy+10<e.y+e.h&&r+n.oy+n.h-10>e.y&&(a-10<e.x&&(a=e.x+e.ox-n.ox-n.w+.1,i=!0,t=!0),a+10>e.x+e.w&&(a=e.x+e.ox+e.w-n.ox-.1,h=!0,t=!0)),t||(r-45<e.y&&(r=e.y+e.oy-n.oy-n.h+.1,o=!0),r+n.oy+n.h/2>e.y+e.h&&(r=e.y+e.oy+e.h-n.oy+.1,s=!0)),n.x=a,n.y=r}}),e[0]=a,e[1]=r,e[2]=o,e[3]=i,e[4]=h,e[5]=s,e}var f=[!1,!1];function P(t,e,a=1,r=0){let o=!1,i=!1,h=e.x,s=e.y;return t.map(({physics:t})=>{var e=h+40*a-4*r,n=s+4*a+40*r;t.containPt(e,n)&&(o=!0),e=h-40*a-4*r,n=s+4*a-40*r,t.containPt(e,n)&&(i=!0)}),e.x=h,e.y=s,f[0]=o,f[1]=i,f}var s=0,u0=3,l=3,A=0,c0=0,d0=1,j=10,K=function(){let a=0,r="The Styx",o=4,i=f0(R),h=f0(g);function t(t){r=M[t],o=4}return{update:function(t){a+=t,o-=t},render:function(t){var e=t.getTransform(),n=(t.setTransform(1,0,0,1,0,0),t.scale(.8,.8),u0);for(let t=0;t<l;t++)t>=n?(i[0][0]="#555",i[3][0]="#555"):(i[0][0]="#e22",i[3][0]="#fff"),h0(i,50+55*t,72,0,0,0);h0(h,50,103,0,a,0),m(s,70,105,"#fff",30),0<o&&(t.globalAlpha=W(o,0,1)*W(4-o,0,1),t.lineWidth=6,i0("#000","#fff"),m(r,40,1.15*y.height,"#fff",100),t.strokeText(r,40,1.15*y.height),t.globalAlpha=1),t.setTransform(e)},enable:function(){a0(11,t)},disable:function(){r0(11,t)},order:1e4}};function Z(t,e,n,a){return t<n+a&&n<t+e}function J(t,e){return Z(t.x+t.ox,t.w,e.x+e.ox,e.w)&&Z(t.y+t.oy,t.h,e.y+e.oy,e.h)}function M0(t,e,n,a,r,o){let i={set:(t,e,n,a,r,o)=>{i.x=t,i.y=e,i.ox=n,i.oy=a,i.w=r,i.h=o},isTouching:t=>J(i,t),containPt:(t,e)=>{return n=i,e=e,(t=t)>n.x+n.ox&&t<n.x+n.ox+n.w&&e>n.y+n.oy&&e<n.y+n.oy+n.h;var n}};return i.set(t,e,n,a,r,o),i}var k=function(n,a,t,e,r,o,i){let h=(t-n)*o,s=(e-a)*o,f=(t=new M0(n=(n-.5)*o,a=(a-.5)*o,0,0,h,s),[[i[0],5,0]]),l=[],u=6*Math.random()+6;for(let t=0;t<h;t+=u)l.push(t,6*Math.random()),l.push(Math.min(h,t+u),2*-Math.random()),u=6*Math.random()+6;return f.push(l),f.push(...r[0]),f.push([h,s,0,s]),f.push(...r[1]),{render:function(t){t.fillStyle=i[1],t.fillRect(n-1,a,2+h,s),h0(f,n,a,0,0,0)},inView:function(t,e){return!(t+900<n||e+600<a||n+h<t-900||a+s<e-600)},tags:["physics"],physics:t,order:-5e3}},E=function(r,o,i,e){let h=0,n=i;return{update:function(t){if(h+=5*t,e-=t,i=Math.min(n*h*2,n),e<.5&&(i=n*e*2,h+=3*t),e<0)return!0},render:function(e){e.fillStyle="#f93";for(let t=0;t<6;t++){var n=(t+h)%6/6,a=i*W(10*n/(1+n*n*15)*(1-n),0,1);e.beginPath(),e.arc(r+Math.cos(4*t)*i,o-40*n*i,10*a,0,6.28),e.fill()}e.fillStyle="#f53",e.beginPath(),e.arc(r+Math.cos(13*h)*i/2,o-4*i,5*i*(1+.1*Math.cos(11*h)),0,6.28),e.fill()},inView:(t,e)=>N(r,o,t,e),order:-4500}},G=function(n,a,t){let r=!1,o=0,i=.1*Math.cos(n*n*18+291*a),h=[],s=1,f=.5<Math.random()?1:-1,l=(0==t&&h.push([["#445",8,0],[0,15,0,0,-7,-7,7,-7,0,0]],[["#445",8,0],[0,50,0,15]]),1==t&&(h.push([["#ccc",7,0],[-17,50,-23,14]],[["#ccc",7,0],[-6,50,-11,3]],[["#ccc",7,0],[5,50,6,-9]],[["#ccc",7,0],[15,50,19,3]]),s=.5*Math.random()+.6),2==t&&(h.push([["#5a5",6,0],[-5,50,-7,20,-10,10]]),h.push([["#5a5",6,0],[-10,10,-20,5,-30,15,-35,25,-25,30]]),h.push([["#5a5",6,0],[5,50,7,30,10,20]]),h.push([["#5a5",6,0],[10,20,20,15,25,25,30,35,20,40]]),s=.5*Math.random()+.7),3==t&&(h.push([["#bb8",6,0],[0,50,0,10],[-10,15,10,15],[-16,40,16,40]]),h.push([["#bb8",6,0],[0,10,0,-20],[-20,-50,0,-20,20,-50],[-13,-10,13,-10]]),s=.5*Math.random()+.6),[0,0,0,0]),u=[0,0,0,0],c=[0,0,0,0],d=null,M=new M0(n,a,-10,-20,20,70);function e([t,,e,n]){n||r||!M.isTouching(t)||(o0(d0,[e]),r=!0,h.map((t,e)=>{l[e]=250*(Math.random()-.5),u[e]=200*-Math.random()-500,c[e]=(4*Math.random()+2)*(.5<Math.random()?1:-1)}),d&&p([d]))}return{update:function(t){if(r&&.7<(o+=t))return!0},render:function(t){var e=t.getTransform();U(s*f,n,a+50,s),t.globalAlpha=1-o/.7,h.map((t,e)=>{h0(t,n+l[e]*o,a+u[e]*o+o*o*1200,0,0,i+c[e]*o)}),t.globalAlpha=1,t.setTransform(e)},enable:function(){0==t&&((d=new E(n,a-7,1,1/0)).order=-6500,x(d)),a0(c0,e)},disable:function(){d&&p([d]),r0(c0,e)},inView:(t,e)=>N(n,a,t,e),order:-6e3}},p0={};function F(A,K){let U=0,N=0,P=0,l=0,Z=1,u=1,J=0,k=0,E=0,c=0,G=0,d=new M0(A,K,-14,-55,28,50),W=0,j=!1,F=!1,M=0,p=0,m=0,C=0,O=2,Y=2,g=1,y=!1,T=0,X=1,H=!1,b=!1,V=!1,q=0,D=!1,w=0,L=0,$=0,x=0,S=0,v=0,I=f0(R),B=(I[1].pop(),I[1].pop(),I[1].shift(),I[1].shift(),I[1][0]=10,I[1][1]=-16,I[1][6]=-10,I[1][7]=-16,I.unshift([10,-16,11,-27]),I.unshift([-10,-16,-11,-27]),I.unshift(["#caa",6,0]),[["#e22",9,0],[0,-37,0,-17],[0,-17,7,0],[0,-17,-7,0]]),z=[["#e22",9,0],[4,0,14,6],["#e66",2,0],[18,5,22,8],[15,9,19,13]],Q=[["#e22",9,0],[0,-17,-16,-6,-26,-6,-32,-15,-34,-22]],t0=[["#ee2",6,0],[0,0,-5,-5,0,-17,5,-5],["#e62",6,0],[0,0,0,-9]],e0=[["#e22",3,0]],n0="rgba(230,100,70,0.5)";function t(t){0==t&&(V=!0,I=f0(R)),1==t&&(j=!0,z.pop(),z.pop(),z.pop(),z.push(["#def",3,0],[18,5,25,8],[15,9,22,13])),2==t&&(D=!0),3==t&&(S=1,e0.push([0,0,-20,-10,-50,-5,-55,15,-25,6,-40,-5,-25,6,-20,-10,-25,6,0,4]))}function e([,t]){t&&(P=300*-t)}return{update:function(i){if(!F){U+=i,g=Math.min(g+i,1),O=Math.min(O+2*i,1),Y=Math.min(Y+2*i,1),q+=i,X+=i;var h=(p0.ArrowLeft?-1:0)+(p0.ArrowRight?1:0);let t=(p0.ArrowUp?1:0)+(p0.ArrowDown?-1:0);var s=Date.now()-p0.KeyX<100,f=Date.now()-p0.KeyV<100;Date.now()-p0.KeyC<100&&b&&V&&3!=v&&.85<X&&(X=0,H=!0,g=0,b=!1,P=1e3*u,o0(5)),3==v&&Math.abs(t)<.3&&.3<Math.abs(h)&&Math.sign(h)==Math.sign(Z)&&(t=1);let e,n,a,r,o=([A,K,e,n,a,r]=l0(s0("physics"),d),n&&0<Z||a&&Z<0);o&&0<=p&&(o=!1),e&&(l=0,c=.15,w=0,e=!0,b=!0),r&&(l=0),3!=v?(H||(.3<Math.abs(h)?(.2<g&&(P+=3e3*Math.sign(h)*i*Math.pow(1-k,6),U+=2*i,J+=4*(1-J)*i),u=Math.sign(h),e&&.13<(M+=i)&&(o0(3),M=-Math.random()/40)):J+=4*(0-J)*i,(Math.sign(h)!=Math.sign(P)||g<.2)&&(P-=14*P*i)),s&&.18<g&&T<3&&(y?O=0:Y=0,T+=1,y=!y,g=0,C=1,P=850*u,l=.25*l-100,o0(c0,[new M0(A,K,50*u-50,-50,100,50),u])),.4<g&&(T=0),f&&1<q&&D&&(q=0,g=0,C=1,P=850*-u,l=.25*l-100,o0(7,[A,K-30,u]))):(w=0,.3<Math.abs(t)?(h=Math.min(6*m,1),K-=370*Math.sign(t)*i*h,N+=18*i*t*h,.13<(M+=i)&&(o0(3),M=-Math.random()/40)):(U+=i,N-=15*Math.sin(N)*i)),Date.now()-p0.KeyZ<100&&.15<x&&(3!=v?0<c?(l=-1e3,x=0,c=0,H=!1,o0(4)):w<S&&(w+=1,L=1,l=-1e3,x=0,c=0,H=!1,b=!0,X=1,o0(6)):(l=-1e3,P=300*-Z,p=.1,v=0,w=0,c=0,x=0,o=!1,o0(4))),o?e&&3==v?v=0:(o&&!e&&(.3<g||H)&&j||o&&e&&.3<t&&j)&&(v=3,H=!1,g=1,P=0):(3==v&&(.3<t||l<-.3)&&(l=-518,P=300*Z,p=.1),v=0),3==v?(b=!0,0<=l?(l-=20*l*i,N+=l/10*i):(l-=10*l*i,N+=-l/10*i)):(g<.2?l+=1e3*i:(c<=.1||l<0)&&(!p0.KeyZ&&l<0?l+=6e3*i:l+=2e3*i),m=0),s0("enemy").map(({enemyHitbox:t})=>{F||X<.3||d.isTouching(t)&&W<=0&&.15<g&&(W=1,g=0,P=1100*Math.sign(A-t.x-t.w/2),l=-100,3==v&&(v=0,P=300*-u),o0(2,1),u0<=0&&(d.ox=-1e3,o0(19,[A,K-30,1,2]),o0(19,[A,K-30,8,1]),F=!0,setTimeout(()=>o0(20),1500)))}),H&&(X<.27?(P=4800*u*(.33-X),l=0):H=!1),Z+=15*(u-Z)*i,W<=.7&&(H||(P=Math.max(Math.min(P,400),-400))),l=Math.min(l,800),E+=17*(l-E)*i,G+=17*((0<c?1:0)-G)*i,k+=((3==v?1:0)-k)*(3==v?17:8)*i,C+=17*((g<.35?1:0)-C)*i,$+=17*(L-$)*i;d.x=A,d.y=K;for(let t=0;t<3;t++)d.x+=i*P/3,d.y+=i*l/3,[A,K,_,_,_,r]=l0(s0("physics"),d),r&&(l=0),F||d.set(A,K,-14,-55,28,50);c-=i,p-=i,m+=i,L=Math.max(L-(3==v?3*i:i),0),x+=i,W=Math.max(0,W-i)}},render:function(t){var e,n,a,r,o,i,h,s,f,l,u,c,d,M,p,m,g,y,b,w,x,v,T,V,q,S,R;F||(e=Math.sign(P)*Math.pow(Math.abs(P/400),.5),a=1-(n=C),o=1-(r=k),h=1-(i=(1-G)*o),f=(1-(s=J*o*a))*o,u=1-(l=$),V=(c=1-Math.exp(6*-O))-Math.pow(O/1.5,2),q=(R=1-Math.exp(6*-Y))-Math.pow(Y/1.5,2),d=6*U,M=(.7*-Z+.2*Math.cos(2*U))*f+(-.6*e+.1*Math.cos(.5*d))*s+-.6*Z*r,p=5*e+Math.min(5*Math.cos(1.5*N),0)*Z*r+(0<Z?15+35*V-40*V*V:-15*V)*n,m=-37*f*a+(-31-e)*s*a+(2*Math.sin(1.5*N)-39)*r+(0<Z?10*V-40:-28)*n,g=-.5*s+-1.2*E/800*o*a+(.9-2*Z)*r+(0<Z?2.8*V-1.2:4*V-.9)*n,y=4*e*a+Math.min(5*Math.cos(1.5*N+3),0)*Z*r+(0<Z?15*q-3:-15-35*q+40*q*q)*n,b=-37*f*a+(e-31)*s*a+(-37-2*Z+2*Math.sin(1.5*N+3))*r+(0<Z?-28:10*q-40)*n,w=.5*s*a+1.2*E/800*o+(-1.5*Z-1)*r+(0<Z?.9-4*q:1.6-2.9*q)*n,x=10*(e*o*a+n*Z)+Z*r*6,v=-37*f*a+-23*(s*a+n)+-43*r,T=.3*M+.2*e+Z*E/2e3*o+1.1*-Z*r+(H?4*(.3-X)*Z:0),V=M+(.15*Math.sin(1.2*N)-.2)*r+(.5*V-.5*q)*n,q=t.getTransform(),S=0<Z?c:R,R=0<Z?R:c,i0(j?"#3af":"#999"),t.translate(A,K),Z<0&&t.scale(-1,1),S<.95&&(t.lineWidth=j?4:2,t.beginPath(),t.ellipse(5,-25,86,20,.1,4*S-2.5,.5+S),t.stroke(),t.beginPath(),t.ellipse(5,-25,76,30,-.2,4*S-2.5,.5+S),t.stroke()),t.setTransform(q),B[1][0]=10*e*a-7*r*Z+15*n*Z,B[1][1]=-37*f*a-23*(s*a+n)-35*r,B[2][2]=(7*f+(7*Math.cos(d)-4)*e)*h*o+(5+E/50)*i*Z*o+(14*Z+Math.min(7*Math.sin(-N),0))*r,B[2][3]=Math.min(7*Math.sin(d),0)*s*h*o+(-4-E/70)*i*o+(9*Math.cos(N)*Z-8)*r,B[3][2]=(-7*f+(7*Math.cos(3.2+d)-4)*e)*h*o+(E/50-6)*i*Z*o+(14*Z+Math.min(7*Math.sin(3-N),0))*r,B[3][3]=Math.min(7*Math.sin(3.2+d),0)*s*h*o+(2-E/70)*i*o+(9*Math.cos(N+3)*Z-8)*r,Q[1][3]=+Math.cos(d)+31-37-E/50,Q[1][5]=+Math.cos(1+d)+31-37-E/40,Q[1][6]=-32-Math.abs(E/290),Q[1][7]=2*Math.cos(2+d)+22-37-E/30,Q[1][8]=E/70-34,Q[1][9]=+Math.cos(3+d)+15-37-E/20,.1<W&&(t.globalAlpha=0<Math.cos(50*W)?.2:1),h0(Q,A,K-8,0,1.57+M+.3*M,0),D&&h0(t0,A,K+Q[1][9]-8,Q[1][8],M+.3*M,.3*-e+.1*Math.cos(K/14)),0<Z?h0(z,A+p,K+m-1.5*Math.cos(3+d)+1,0,M,g):h0(z,A+y,K+b-1.5*Math.cos(3+d)+1,0,3.14+M,w),t.fillStyle,h0(e0,A-2,K-37+6*n,0,0*l+(.4*M+1.4)*u,-.7*u+E/2e3-l*l*4+2.8*L,n0),h0(e0,A+2,K-37+6*n,0,3.14*l+(.4*M+1.6)*u,.7*u+E/2e3+l*l*4.4-2.8*L,n0),h0(B,A,K-8,0,M,0),h0(I,A+x,K+v+1.5*Math.cos(1+d)+1,10,V,T),0<Z?h0(z,A+y,K+b-1.5*Math.cos(3+d)+1,0,3.14+M,w):h0(z,A+p,K+m-1.5*Math.cos(3+d)+1,0,M,g),t.globalAlpha=1,i0(j?"#3af":"#999"),t.translate(A,K),Z<0&&t.scale(-1,1),R<.95&&(t.lineWidth=j?4:2,t.beginPath(),t.ellipse(5,-25,86,20,.2,-R,3-4*R),t.stroke(),t.beginPath(),t.ellipse(5,-25,76,30,.1,-R,3-4*R),t.stroke()),X<.24&&(t.translate(-120,0),i0("#eee"),t.lineWidth=4,t.beginPath(),t.ellipse(5,-36,80,10,-.1,1-8*X,3-15*X),t.stroke(),t.beginPath(),t.ellipse(5,-36,70,5,.1,1-8*X,3-15*X),t.stroke()),t.setTransform(q))},enable:function(){a0(14,t),a0(d0,e)},disable:function(){r0(14,t),r0(d0,e)},order:1e3,tags:["player"],playerHitbox:d,grant:t,reset:function(t,e){F=!1,d.x=t,d.y=e,P=0,l=0,s0("camera")[0].aim(t,e,1,!0)}}}function C(l,u,t){let c=10*Math.random(),o=0,i=0,h=127<t?-1:1,d=h,M=0,s=3,f=new M0(l,u,0,0,0,0),p=[["#fff",5,0],[0,-13,4,-29,13,-40],[0,-16,-2,-17],[2,-22,-3,-24],[4,-28,0,-30],[6,-33,4,-35]],m=[["#fff",5,0],[-8,0,0,-13,8,0]],g=[["#fff",5,0],[0,0,14,15]],y=[["#fff",9,0],[3,10,-3,10,-3,0,-6,-4,0,-10,6,-4,3,0,3,10],["#000",4,5],[-5,-6,-3,-5],[5,-6,3,-5]];function e([t,e,n,a]){f.isTouching(t)&&0<s&&(o=600*e,h=-Math.sign(e),M=1,(s-=a?2:1)<=0&&o0(19,[l,u-55,4,1]),o0(d0,[n]))}return{update:function(t){if(s<=0)return!0;var e,n,a,r;i+=1400*t,[l,u,e,n,a,r]=l0(s0("physics"),f),[hasRight,hasLeft]=P(s0("physics"),f,.5),e&&500<i&&(s=0,o0(19,[l,u-55,4,1])),(n||!hasRight&&e)&&(h=-1),(a||!hasLeft&&e)&&(h=1),(e||r)&&(i=0),M<=0&&e&&(o=60*d),0<M&&(o-=12*o*t),c+=t,l+=o*t,u+=i*t,d+=8*(h-d)*t,M=Math.max(0,M-2*t),f.set(l,u,-20,-59,40,60)},render:function(t){var e=.6*d,n=6*c,a=t.getTransform(),r=(U(1.3,l,u),Math.cos(n)/20*1-d*M*.3),o=7*e*1+50*r,i=0*(-33-2*e+Math.cos(n))+ +(-33-2*e+Math.cos(n-1)),h=7*e*1+50*r,s=0*(2*e-33+Math.cos(n))+ +(2*e-33+Math.cos(2+n)),f=+(-40+Math.cos(1+n));m[1][0]=8*Math.cos(n)*d*1,m[1][1]=4*Math.min(0,Math.sin(n))*1,m[1][4]=8*Math.cos(3+n)*d*1,m[1][5]=4*Math.min(0,Math.sin(3+n))*1,.2<M&&(t.globalAlpha=0<Math.cos(25*M)?.2:1),h0(m,l,u,0,e,0),h0(g,l+o,u+i,-4,2.1*e,-e/3),h0(g,l+h,u+s,4,2.1*e+3.14,-e/3),h0(p,l,u,0,2*e-1.57,r),h0(y,l,u+f,23+70*r*d,-e,-M*d*.6),t.globalAlpha=1,t.setTransform(a)},enable:function(){a0(c0,e)},disable:function(){r0(c0,e)},inView:(t,e)=>N(l,u,t,e),order:500,tags:["enemy"],enemyHitbox:f}}window.onkeydown=t=>{p0[t.code]||(p0[t.code]=Date.now()),o0(17)},window.onkeyup=t=>{delete p0[t.code]};var O=[0,3.1,4.7,1.5];function t(u,c,t){let d=10*Math.random(),o=0,i=0,h=127<t?-1:1,s=t%4,M=h,p=0,f=4,m=0,g=0,y=!1,l=3*Math.random(),b=[-50,0,-50,-59].map(t=>1.1*t/1.3),w=[-59,-50,0,-50].map(t=>1.1*t/1.3),x=[100,60,100,60].map(t=>1.1*t/1.3),v=[60,100,60,100].map(t=>1.1*t/1.3),T=6.28*s/4,V=Math.cos(T),q=Math.sin(T),S=(u-=50*q,c+=50*V,new M0(u,c,0,0,0,0)),e=[];for(let t=0;t<21;t++)e.push(24*Math.cos(t/20*6.28),17*Math.sin(t/20*6.28));let R=[["#fff",5,0],e],A=[["#000",4,0],[-7,-6,-3,-5],[7,-6,3,-5],["#000",4,3],[-7,0,-3,1],[7,0,3,1],["#000",4,4],[-7,6,-3,7],[7,6,3,7]],K=[["#fff",5,10],[6,0,0,0,0,0,0,0],[-6,0,0,0,0,0,0,0],["#fff",5,-10],[6,0,0,0,0,0,0,0],[-6,0,0,0,0,0,0,0]];function n([t,e,n,a]){S.isTouching(t)&&0<f&&(p<=0&&(o=300*e*Math.abs(V)+200*q,i-=200*V),m<=0&&g<=0&&(h=-e),p=1,(f-=a?2:1)<=0&&o0(19,[u+S.ox+S.w/2,c+S.oy+S.h/2,7,1]),o0(d0,[n,a?0:e]))}return{update:function(t){if(f<=0)return!0;var e,n,a,r;o-=1300*q*t,i+=1300*V*t,[u,c,e,n,a,r]=l0(s0("physics"),S),[hasRight,hasLeft]=P(s0("physics"),S,1.3*V*1.1,1.3*q*1.1),0==s&&(!n&&hasRight||(h=-1),!a&&hasLeft||(h=1),e&&0<i&&(i=0)),1==s&&(!e&&hasRight||(h=-1),!r&&hasLeft||(h=1),a&&o<0&&(o=0)),2==s&&(!n&&hasLeft||(h=1),!a&&hasRight||(h=-1),r&&i<0&&(i=0)),3==s&&(!e&&hasLeft||(h=1),!r&&hasRight||(h=-1),n&&0<o&&(o=0)),l<0&&(g=.5,o=0,i=0,y=!0,l=2*Math.random()+1.5),g<=0&&y&&(m=.6,y=!1),0<m&&(s%2==0?o=(800*m+100)*M*V:i=(800*m+100)*M*q),g<=0&&(p<=0?m<=0&&(s%2==0?o=50*M*V:i=50*M*q):s%2==0?o-=12*o*t:i-=12*i*t),d+=0<g?2*-t:t*(1+2*m),u+=o*t,c+=i*t,M+=8*(h-M)*t,p=Math.max(0,p-2*t),m=Math.max(0,m-t),g=Math.max(0,g-t),l-=t,S.set(u,c,b[s],w[s],x[s],v[s])},render:function(t){var e=.6*M,n=11*d,a=t.getTransform(),r=(U(1.1,u,c),32+Math.cos(n)),o=y?(40*g*g-10)*M:0,i=Math.cos(n/2)/15*1+T+m*M;for(let t=0;t<4;t++){var h=t%2?1:-1,s=O[t],f=t<2?-3:7,l=t<2?1+t:2+t;K[l][2]=11*h-4*Math.cos(n+s)*M*1,K[l][3]=12,K[l][4]=(40+f)*h-2*Math.cos(n+s)*M*1,K[l][5]=4*Math.cos(n+s)*1-5,K[l][6]=(44+f)*h-9*Math.cos(n+s)*M*1,K[l][7]=+Math.min(10*-Math.sin(n+s),0)+20}.2<p&&(t.globalAlpha=0<Math.cos(25*p)?.2:1),h0(K,u+21*q,c-21*V,0,1.4*-e,T),h0(R,u+r*q+o*V,c-r*V+o*q,0,e/2,e/2+i,"#fff"),h0(A,u+r*q+o*V,c-r*V+o*q,17,-e,-e/2+i,"#fff"),t.globalAlpha=1,t.setTransform(a)},enable:function(){a0(c0,n)},disable:function(){r0(c0,n)},inView:(t,e)=>N(u,c,t,e),order:500,tags:["enemy"],enemyHitbox:S}}var Y=[7,14,11],X=[1,3,7],H=["#a63","#889","#db1"],L=["#742","#667","#b90"];function I(r,o,i){let h=0,s=0,n=3*i,a=new M0(r-25,(o+=50)-55,0,0,50,55);var t=H[i-1];let f=L[i-1],l=[[t,8,0],[20,0,-20,0,-28,-23,28,-23,20,0],[t,8,0],[-28,-23,-24,-40,24,-40,28,-23],["#ffa",8,0],[0,-27,0,-19]];function e([t,,e]){a.isTouching(t)&&(h=1,s=7*Math.random(),--n,o0(19,[r,o-20,1,1]),o0(d0,[e]))}return{update:function(t){if(n<=0)return o0(19,[r,o-20,Y[i-1],1]),o0(19,[r,o-20,X[i-1],2]),!0;h=Math.max(h-t,0)},render:function(t){var e=Math.exp(6*h-3),n=2+Math.abs(12*Math.cos(20*h))*e/10,e=Math.cos(30*h+s)*h*e/60,a=t.getTransform();U(.75+.15*i,r,o),h0(l,r,o-n,0,0,e,f),t.setTransform(a)},enable:function(){a0(c0,e)},disable:function(){r0(c0,e)},inView:(t,e)=>N(r,o,t,e),order:-6e3}}var B=[["#f52",6,0]];for(let t=-50;t<50;t+=26)B.push([t,50,t+10,25,t+10,140,t+10,25,t+20,50]);var z=[["#f82",40,0],[-47,50,47,50]];function r(o,i,h){let s,f=0,l=Math.random(),a=Math.random()+.5,u=80*(Math.random()-.5),r=0,c=h<4?1:0;return h%4==0&&(s=new M0(o,i,-45,35,90,90)),h%4==1&&(s=new M0(o,i,-125,-45,90,90)),h%4==2&&(s=new M0(o,i,-45,-125,90,90)),{update:function(t){1<(l+=t*a)&&(a=2*Math.random()+.5,l=0,u=80*(Math.random()-.5));var e=(Date.now()+1500*c)%3e3;let n=0;4<=h&&h<=7&&0==(r=1500<e?1:0)&&500<e&&(n=Math.cos(e/20)/20),f+=15*(r+n-f)*t},render:function(t){var e,n=1.57*h,a=Math.sin(n)*f*91,r=-Math.cos(n)*f*91;8==h?(t.fillStyle="#f82",t.beginPath(),e=l,t.arc(o+u,i+50-40*e,40*(e-e*e),0,2*Math.PI),t.fill(),h0(z,o,i,0,0,0)):h0(B,o+a,i+r,0,0,n),s.x=o+a,s.y=i+r},inView:(t,e)=>N(o,i,t,e),order:-6e3,tags:["enemy"],enemyHitbox:s=h%4==3?new M0(o,i,35,-45,90,90):s}}function o(n,a,r){let o=!1,e=50,i=[["#fff",8,0],[0,0,0,-200],[-50,-190,50,-190],[-50,-20,50,-20]],h=([-1,1].map(t=>{i.push([20*t,0,25*t,-200],[40*t,0,43*t,-230,40*t,-260,30*t,-260,25*t,-250,33*t,-245])}),new M0(n-50,a-220,0,0,100,220));function t([t,e]){t==r&&(o=e)}return{update:function(t){e+=((o?-150:50)-e)*t,h.y=a+e-220},render:function(t){h0(i,n,a+e,0,0,0)},enable:function(){a0(j,t)},disable:function(){r0(j,t)},inView:(t,e)=>N(n,a,t,e),tags:["physics"],physics:h,order:-7e3}}function Q(n,a,r,t=0){let o=!1,i=1==t,h=0,s=new M0(n-40,a-15,0,0,80,65),f=[["#a53",8,0],[0,0,0,-60,-5,-68,0,-76,5,-68,0,-60]],e=[["#a53",8,0],[-30,50,-16,28,16,28,30,50],[-18,50,-10,38,10,38,18,50]];function l([t,,e]){s.isTouching(t)&&!o&&(o=!0,o0(j,[r,o]),o0(d0,[e]),s.x=-1e3)}return{update:function(t){var e=o^i?1:-1;h+=10*(.7*e-h)*t,f[0][0]=o?"#5af":"#a53"},render:function(t){h0(f,n,a+50,0,0,h),h0(e,n,a,0,0,0)},enable:function(){a0(c0,l)},disable:function(){r0(c0,l)},inView:(t,e)=>N(n,a,t,e),order:-6e3}}function u(t,e,n){return Q(t,e,n,1)}function c(r,o,i){let h=0,s=0,f=!1,l=0,u=!1,a=[["#777",5,0],[200,60,-200,60,-200,0,-100,0,-100,-50,100,-50,100,0,200,0,200,60]],c=[["#911",10,0],[-100,-40,-100,-50,100,-50,100,-25],[-70,-50,-70,-25],[40,-50,40,-15],[60,-50,60,-35]],d=[["#fff",6,0]],e=[],n=[],M=1.256;for(let t=0;t<6;t++)e.push(100*Math.sin(t*M),100*-Math.cos(t*M)),n.push(100*Math.sin(t*M*2),100*-Math.cos(t*M*2));d.push(e,n);let p=f0(v),m=w.createLinearGradient(r,o-50,r,o-250);m.addColorStop(0,"rgba(255,255,110,0.5)"),m.addColorStop(.3,"rgba(255,255,110,0.2)"),m.addColorStop(1,"rgba(255,255,110,0.0)");var t=new M0(r-200,o,0,0,400,50),g=new M0(r-100,o-50,0,0,200,50);let y=new M0(r-75,o-60,0,0,150,10),b={tags:["physics"],physics:g};return{update:function(e){if(h+=e,f)s=3,l+=e;else if(J(y,s0("player")[0].playerHitbox)){u||(o0(12),u=!0),s+=e;let t=s0("camera")[0];var n=s/3,a=1-n;if(t.aim(t.getX()*a+r*n,t.getY()*a+(o-100)*n,1+.4*Math.sqrt(s)*n,n),3<s){f=!0,d[0][0]="#ee2",p.map(t=>{t[0][0]="#ee2"});for(let t=0;t<20;t++)o0(19,[r+150*(Math.random()-.5),o-100,1,1]);o0(14,i),l=0}}else s-=2*s*e,u&&(o0(13),u=!1)},render:function(t){var e=5*Math.sin(2*h)-200;h0(a,r,o,0,0,0,"#777"),f?(d[0][1]=4,t.fillStyle=m,t.fillRect(r-100,o-250,200,200)):(t.globalAlpha=.5*Math.cos(s*s*10)+.5,d[0][1]=6*(1-s/3)),h0(d,r,o+e,0,0,1.256*-s/3),t.globalAlpha=1,h0(c,r,o,0,0,0);for(let t=0;t<5;t++){var n=3*Math.cos(.2*t+3*h)+130;h0(p[i],r+Math.sin(t*M)*n,o+e-Math.cos(t*M)*n,0,0,s*s*7*(t%2-.5))}},enable:function(){x(b)},disable:function(){remove(b)},inView:(t,e)=>N(r,o-100,t,e),tags:["physics"],physics:t,order:-8e3}}function d(r,o,i){let h=0,s=0,f=!1,l=!1,e=[["#777",5,0],[100,60,-100,60,-100,0,100,0,100,60]],n=[["#911",10,0],[-100,10,-100,0,100,0,100,25],[30,0,30,25],[-70,0,-70,35],[60,0,60,15]],a=f0(R),u=(a[0][0]="#ee2",a.splice(3,3),f0(v)),c=w.createLinearGradient(r,o,r,o-200);c.addColorStop(0,"rgba(255,255,110,0.3)"),c.addColorStop(.3,"rgba(255,255,110,0.1)"),c.addColorStop(1,"rgba(255,255,110,0.0)");var t=new M0(r-100,o,0,0,200,50);let d=new M0(r-75,o-10,0,0,150,10);function M(){i==A&&s0("player")[0].reset(r,o-150)}return{update:function(e){if(f=A==i,h+=e,f)s=3;else if(J(d,s0("player")[0].playerHitbox)){l||(o0(12),l=!0),s+=e;let t=s0("camera")[0];var n=s/3,a=1-n;t.aim(t.getX()*a+r*n,t.getY()*a+(o-100)*n,1+.4*Math.sqrt(s)*n,n),3<s&&o0(15,[i])}else l&&(o0(13),l=!1),s-=3*s*e},render:function(t){u.map(t=>{t[0][0]=f?"#ee2":"#4af"}),h0(e,r,o,0,0,0,"#777"),f?(t.fillStyle=c,t.fillRect(r-50,o-200,100,200),h0(a,r,o-50+4*Math.cos(5*h),0,h,0)):t.globalAlpha=.5*Math.cos(s*s*15)+.5;for(let t=0;t<5;t++)h0(u[t],r-40*(t-1.9),o+25,0,0,0);t.globalAlpha=1,h0(n,r,o,0,0,0)},enable:function(){a0(20,M)},disable:function(){r0(20,M)},inView:(t,e)=>N(r,o,t,e),tags:["physics"],physics:t,order:-8e3}}var D=[0,0,["#b72","#741",1,2,7,7,5,3,[3,3,1,2,0],3],0,function(a,r){r-=50;let o=!1,i=0,e=0,h=0,s=0,f=0,l=[["#fff",4,0]],u=[],c=[];for(let e=0;e<8;e++){let t=(Math.random()-.5)/4-2.3+e%4/2;3<e&&(t+=3.14);var n=110/Math.abs(Math.sin(t));u.push(t),c.push(n),l.push([0,0,Math.cos(t)*n,Math.sin(t)*n])}let d=[],M=(l.push(d),new M0(a-50,r-100,0,0,100,200));function p(){for(let t=0;t<8;t++)l[1+t][0]=h,l[1+t][1]=s;for(let t=0;t<32;t++){var e=u[t%8],n=(t/70+.07)/(1-.5*Math.abs(Math.sin(e))),a=c[t%8]*n;d[2*t]=Math.cos(e)*a+h*(1-n),d[2*t+1]=Math.sin(e)*a+s*(1-n)}}function t([t,,e,n]){if(M.isTouching(t)){if(f=10,n&&!o){o=!0;for(let t=0;t<18;t++)setTimeout(()=>{o0(18,[a+170*(Math.random()-.5),r+190*(Math.random()-.5)+20,+Math.random()+1,.5*Math.random()+.5])},Math.random()*(100+33*t));M.h=0}n||o0(16),o0(d0,[e])}}return p(),{update:function(t){if(e+=56*t,f-=5*f*t,h=f*Math.cos(e),s=.8*f*Math.cos(e/1.4),p(),o&&1<(i+=t))return!0},render:function(t){var e,n;o&&(e=1-i,n=Math.max(255-1e3*i,0),l[0][0]=`rgb(${n},${n},${n})`,l[0][1]=4*e),h0(l,a,r,0,0,0)},enable:function(){a0(c0,t)},disable:function(){r0(c0,t)},inView:(t,e)=>N(a,r,t,e),order:-9e3,tags:["physics"],physics:M}},0,I,2,C,0,I,1,I,3,t,2,r,3,r,1,t,3,["#fc1","#a71",9,9,3,1,1,0,[0],4],0,r,8,C,128,0,0,d,4,c,4,r,0,o,6,c,3,u,6,["#b5c","#535",7,7,4,2,1,2,[1,1,1,3,0],2],0,d,5,t,0,["#a99","#433",5,1,4,9,2,1,[0,0,0,1,3],0],0,["#474","#242",2,3,1,1,5,4,[2,2,2,0],1],0,t,128,r,6,Q,1,o,1,c,0,o,4,F,0,Q,2,o,2,u,4,d,2,o,0,d,1,u,0,d,0,t,1,u,5,d,3,r,2,o,3,u,3,u,8,o,5,r,4,o,7,o,8,u,7,c,2,c,1],$=function(){let e=new Image,u=null,c,d,M=100,p={},n=(D.map((t,e)=>{t[0]&&(p[e]=t)}),0),m={};function g(t,e){t=t+e*c<<2;return u[2+t]}let a=[0,0,0,0,0,0,null];return{generate:async function(){await new Promise(t=>{e.onload=t,e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAABjCAAAAACTN1ASAAAABGdBTUEAALGPC/xhBQAACHdJREFUeAHdwYl2HFlWBdB9ZamdWWEnCLj4HQpoZmgohmL6/0/jRUROsmV3C0wvFnv7v6d+M6iN76pQNuVzhTIVVaYq30NdoGzK1YNNoXinKJvyPZRdeWd6RNlUqSo8KZSaKPyC8j0UNakrZVMo1OSsVJVa+R4KZVe8R+HRpqzKRSnToXwfhbIrm0KVVZUq5aKU6VC+j0JRhVqpMhVFoZSLUnVE+T6KKgo/1EqVq0IpF1V1NNXyOm9UlLOq8lKhUB92dbSp5ehLh8UbFcVHq6qyq3JV6sZ0qKrl6EuHxdtUUapMVS4KVdRK2ZTdoViOvnRYvE2hKFSV3aNN2ZSyqaM6UlUsR6vFbrE6LN6mUDblrMpZTUpVqemojpRpOZqWxW5ZTIfF21RRpkebKpRVTe7UkTpSpuVoWlwspsPijYpCFaffOSkXNblXqKMq03I0LU6n0++eTieL6bB4o6JQ1MZFTe6VzaFMy9G0LJaVZTEdFm9UlJuibEpVuVOqjijTcrRaLqwOizcqqp6n8uBJfdgVv0dxOp1+/3Q6oezKtBytlsWyLJbF6rB4o0J9hbqjjqgPH8q0HG0WFhabw+KNCoVCFWX13lTKxaHUkVqZlqPNslgsi81h8UZFlZtyVcrFoRTK2XK0WXY2h8UbFVVuiiqbUv5AlelQCuVsOdotK7vD4o2KKk8KVapK2ZXamA6lyqGcLUe7ZWV3WLxRURuPyqZQRanJ5lCKQzlbjnYLFrvD4o2KOlN4oOxKTTaHUihny9FuWdkdFm9UqKOpTFXlpsrZodSRslqmo7NlWZwdFm9UqKOpXFWhVqZHHEqhlo1XLCtvVEUdeadsHk2FclZlVVQti9cti8/1zrcUdVQTVVShUJ5MH50Vh1rw4GK54wtt1b6lqKNdOSvU51ALy+T0hycsvqWt2rcU9bxC+TVqMS1XvqXxTvuWonYURRWqrD55oZbJsnIxbrzQrSffUqiVi7IqdaE2qGWxWpbFxViZxsqd1pNvqEKt8Gj6oazKWZVyVovdsrgYw26s3Gm0bwmyo8pUVoUHU5XyzqYWu2VxMYYnF8PNmHS3r4spO5+pKk+q1GRVY1iNzzkbpnGju31dgtw4e6QuqKoPqxpjYGy8Yrxg1b4hZGOVDNN4ybiDsfGZMRhnGGNYtW8IiU0iGR+msXFnXGFsMIY7wzRW7rSvS/iEPyKJZFx4zRgDY8cYNsNqDPy44h0PNu3r8oJkXPi6YYxhMIY7A+MFfeFVSZxFJOPMb2CM4WysMO7YNdqrEqskVgljDHcGw9UfW/0J/oQxxul0+tPT6cQYA2NjM9y0VyXIxi8lXhrOBmPnz4wxjM8ZpoFhM+zak/aqhEyysXqwGx9eGBhjYIyBMXzuzw1f6JVXJSTujTEYrzCNgbEyDR9d/AVjpdum7XrlVQnBL/GXPGGMYTXG8KWB8ZLVuNCNTzROf3XSK69KCHIxNqZh+NLAGG7GZDfGQF/pK69KiF1WY+NVYzAwvDDGcKev9JVXJSQukjEwxsBf8+hq2AwMT770aNfdvEfrbrynvSohiVeMneGjwRimMTAmxsCj3Tjrjam1q/aKTEhcPbkYO2PFGL40xrAZVmP0hidt1TbtTq68lIxhN8bwueErxsA7Y7Sp9WTVVj+0O0EmN6e/OZFkDJsx+VtfOv3dyUtjWI1V86T5ZPNDmx61O3GTmHIxhmlc8JFHu4GxcmesTGPV+kZP9M5FPAmJs1yNYRqfY7zAGIzBWJnGqm3a1Gir92gXWZHEJolNMqYP/339K6t21r9y1i6yQhJTEmcZ/zPtpaZptJskzj76Qqyy8jbt703tk7NPdu1OYpf4QqzyhX6NO31P3+h2J4lVJneSEEKQCy90t7P+CmftvanbTVbIxlk2VnERsXvgEw9e6Bc03qPpNrVN76yycxNTTLGK6Z07SfqMB9PpH050908//dTdP/lMO+t21qZcuEhM8USeVyEb/tE/IZNNn+luPflnP/30kwf8i7N21mg8mBqJKSu7TMgkO3LHKjZ9prv15sPU3bqb1jQ+mfrnn03d7UkjNpk88lE2SEgiyfNzEmRninutu/U93W3zQ78OQUjkSpwlyMYqF+JOt+7Wk3bW3fz888+0q+6m21n8QohVNlaxSkyZTE8ykUTcadpNW/WN7nbT7Swr4l/x44/8+KMpiUdJ3GRjSsSd1m3V/g1t1T7aPNIuHjzpdpHY5EZu3GRlE3GndVv1he7WrVuvnPXOVWwyOcsdd5KYnkTcafpXpr6w+mh6RLeL3riKXWJ6fn7OS26SIJO4063d6Zd0u9ftKnaJfydnyMpLCRLiXms+4cGq++iiu3U7nU7/cTqdeKDbVSb5jF1sHuMssYs73foK3Ue7X+hu/YJuN0nkM+4lMT26Sdxpq/doq+6jTW/0C7rdSSR2SSRx8dGUmBIXSdxpq49oq+6jTW98ptudRFwECYeEJC4SZ1m50zTdVh/pPjrrSXd7oK/cCTE98hFPEiRITB+tggSZ3Gvaps+OznrSG33lTiTkHhJnSUwhMSXxQps+mdqq20237jb1Ct3uRBJJyNmRxPRoSuwSU+KlvrHqdtOtu+luu253IonEJpujBEmQuJPEt3XjEz7ZdLfdg6nbnUgirmJKkJhi+miXxK/Rmw8fPvSVTXd70u0msUq8kJjiLAnZ+HX6VR9WvXGVRHbOEjLZPNokZOPt+iVnWUkkcZYgO5JYBdn4boKIewlyxCEk7mTy3cQq7iUccjSFuJfJdxNPInEnQaziC4nvJitJOJ1O/3k6nUgQDpF4fub5mednm8R3lIQgO5Ij4RB5gScS31MSIRcSBCEJiVV2vq8EuYcgzuJ/UT7HIUfiLH6LYheen5/9QvwW5fkZz8+58luUL/j/578AqFT/Rxl3KMMAAAAASUVORK5CYII="});let t=y.getContext("2d");t.drawImage(e,0,0),c=e.width,d=e.height,u=t.getImageData(0,0,c,d).data,t.clearRect(0,0,c,d);for(let n=0;n<c;n++)for(let e=0;e<d;e++){var a=g(n,e);let t=D[2*a];a=D[2*a+1];t&&!t[0]&&x(new t(n*M,e*M,a)),m[n]=m[n]||{},m[n][e]=function(n,a){let r=[0,0,0,0,0,0,null],o={},i=.001;for(let e=-4;e<=4;e++)for(let t=-4;t<=4;t++){var h=g(n+e,a+t)<<1,s=p[h];if(s){o[h]=!0;for(let t=0;t<6;t++)r[t]+=s[2+t];i++}}var t=Object.keys(o);r=r.map(t=>10*t/i),1==t.length&&(r[6]=t[0]);return r}(n,e)}let r={};for(let n=0;n<c;n++)for(let e=0;e<d;e++){var o=g(n,e)<<1;if(p[o]&&!r[n+","+e]){let t=e;for(;t<d;){if(o!=g(n,t)<<1)break;r[n+","+t]=!0,t++}r[n+","+e]=[e,t,o]}}let i={};for(let n=0;n<c;n++)for(let e=0;e<d;e++){var h=r[n+","+e];if(h?.length&&!i[n+","+e]){let t=n;for(;t<c;){var s=r[t+","+e];if(!s?.length)break;if(s[1]!=h[1]||s[2]!=h[2])break;i[t+","+e]=!0,t++}var f=function(e,n,a,r){let o=[],i=[],h=[],s=[];for(let t=n;t<r;t++){var f=g(a,t)<<1,f=(h.length||p[f]||h.push((a-e)*M,(t-n)*M),h.length&&p[f]&&(h.push((a-e)*M,(t-n)*M),o.push(h),h=[]),g(e-1,t)<<1);s.length||p[f]||s.push(0,(t-n)*M),s.length&&p[f]&&(s.push(0,(t-n)*M),i.push(s),s=[])}h.length&&(h.push((a-e)*M,(r-n)*M),o.push(h));s.length&&(s.push(0,(r-n)*M),i.push(s));return[o,i]}(n,e,t,h[1]);x(new k(n,e,t,h[1],f,M,p[h[2]]))}}for(let e=0;e<c;e++)for(let t=1;t<d;t++){var n=p[g(e,t)<<1],l=g(e,t-1);n&&!l&&.5<Math.cos(1321*e+2831*t)&&x(new G(e*M,(t-1)*M,n[8][(13*e+17*t)%n[8].length]))}},tags:["map"],getTheme:function(t,e){return(t=m[parseInt(t)]?.[parseInt(e)])&&(a=t)[6]&&n!=t[6]&&(o0(11,p[t[6]][9]),n=t[6]),a}}},t0=function(h,s){let f=s0("player")[0],l=(h=f.playerHitbox.x,s=f.playerHitbox.y,0),u=0,c=h,d=s,M=1,p=M,m=[0,0,0],g=[0,0,0];function t(){u=.5}return a0(2,t),a0(14,t),a0(15,t),{update:function(e){var t,n,a,r;l+=e,u=Math.max(u-e,0),h+=12*(c-h)*e,s+=12*(d-s)*e,p+=3*(M-p)*e,M+=4*(y.width/1500-M)*e,0<u0&&(t=f.playerHitbox.x,n=f.playerHitbox.y,{width:a,height:r}=y,r=r/8,t<h-(a=a/10)&&(c=t+a),h+a<t&&(c=t-a),n<s-r&&(d=n+r),s+.8*r<n&&(d=n-.8*r));let o=s0("map")[0];var i=o.getTheme(h/100,s/100);for(let t=0;t<3;t++)g[t]+=3*(i[t]-g[t])*e,m[t]+=3*(i[t+3]-m[t])*e;document.body.style=`background:linear-gradient(0deg,rgb(${m.join(",")}) 0%,rgb(${g.join(",")}) 100%)`},set:function(t){var e=3*Math.cos(l)+15*Math.cos(40*l)*u,n=3*Math.cos(.8*l)+8*Math.cos(23*l)*u;t.translate(y.width/2,y.height/2),t.scale(p,p),t.translate(e-h,n-s)},aim:function(t,e,n,a){c=t,d=e,M=n*y.width/1500,a&&(h=c,s=d,p=M)},getX:function(){return h},getY:function(){return s},getBgBot:function(){return m},order:-1e4,tags:["camera"]}},e0=function(o,i,h,s,f=1){let l=7*Math.random(),a=7*Math.random(),u=0,c=!1,d=0,M=10+3*Math.random(),r=20*Math.random()-15,p=new M0(o,i,1,1),m;return m=1==f?f0(g):[["#fff",9,0],[3,10,-3,10,-3,0,-6,-4,0,-10,6,-4,3,0,3,10],["#000",4,5],[-5,-6,-3,-5],[5,-6,3,-5]],{update:function(t){var e,n,a,r;if(l+=t,d+=t,s+=2e3*t,d>M&&(c=!0),[o,i,e,n,a,r]=l0(s0("physics"),p),(n||a)&&(h=-h),e&&(200<s?(o0(9),s*=-.4):s=0,h-=9*h*t),r&&(s=0),c?u+=3*t:s0("player").map(({playerHitbox:t})=>{p.isTouching(t)&&.35<d&&(c=!0,o0(8,9*f-8))}),.5<u)return!0;o+=h*t,i+=s*t,p.set(o,i,-15,-20,30,40)},render:function(t){var e=3*l,n=.2*Math.cos(l+a)+a;c?(i0(`rgba(255,255,180,${1-2*u})`),t.beginPath(),t.arc(o,i+r,40*u+10,0,6.28),t.fill()):h0(m,o,i+r,0,e,n)},collectHitbox:p}},n0=function(i,h,s){let f=300*s,l=this,u=0,r=[["#fb1",10,0],[10,0,0,-10,-10,0,-15,-5,-20,0,-28,0,-20,0,-15,5,-10,0,0,10,10,0],["#f82",10,0],[2,0,-4,0]],c=new M0(i+=40*s,h,-20,-15,30,30);function t([t]){t==l&&(l=null)}return{update:function(t){var e,n,a,r,o;return u+=t,!l||9<u||(o0(c0,[c,s,l,!0]),[e,e,n,a,r,o]=l0(s0("physics"),c),n||a||r||o?(o0(18,[i,h,2,.5]),!0):(f=W(f+1e3*t*s,-750,750),i+=f*t,void(c.x=i)))},render:function(t){i0("#fb1"),t.beginPath();var e=Date.now(),n=e%100/100,a=40*(n-n*n);t.arc(i-(5+42*n)*s,h+4*Math.cos(e/20),a,0,6.28),t.fill(),h0(r,i,h,0,0,1.57*s-1.57)},enable:function(){a0(d0,t)},disable:function(){r0(d0,t)}}},m0=function(){let v=null,T=null,r,o,i,h,s,f,l,u,c,d,M,p,m,g,y,b,w,x,V,q,n,S,R,e,a=!0,A=t=>Math.sin(t),K=t=>(t%6.28-3.14)/6.28,U=t=>W(1e3*Math.sin(t),-1,1),N=(t,e)=>W(Math.sin(t)*e,-1,1);function P(t,e){var t=v.createBuffer(1,T*t,T),n=t.getChannelData(0),a=t.length;for(let t=0;t<a;t++)n[t]=e(44100*t/T)*(1-t/a);return t}function Z(n,a){let r=[],t=[];var o=[1,4,2,.5,3,4][n],i=[1,1,.5,.25,2,2][n],h=[-15,-20,-19,-12];t.push([n*n*3*.5%2,n%2],[.5*(n*n*3+9*n)%2,(n+1)%2],[.5*(n*n*2+11*n)%2,(n+1)%2]);for(let e=0;e<3;e++){var s=8*e,f=[0,3,-5][e];for(let t=0;t<8;t++)r.push([h[(7*n+2*e+(t>>1)+t*t*3)%h.length]+f,t+s,6,1]);for(let t=0;t<8/i;t++)(t+t*t+e+3*n)%7<4&&r.push([-3+f+a[(t+t*t*2+e*e*2+n)%a.length],t*i+s,o,2])}return[r,t]}function J([e,n],a){let t=v.createBuffer(1,8*T*3*a,T),r=t.getChannelData(0);for(let t=0;t<e.length;t++){[o,i,h,s]=e[t],g=m=p=M=d=c=u=l=f=void 0;var o,i,h,s,f=r,l=i*a,u=h*a,c=s,d=6*2**(-o/12)*2,M=parseInt(l*T),p=parseInt(u*T);for(let t=0;t<p&&t<f.length;t++){var m=0,g=t/p;m+=1==c?2*N(t/(2*d)+A(t/8e3),44*Math.exp(23*-g)+1):7*K(t/(4.03*d)),f[M+t]+=m*Math.min(g*Math.exp(-g*(10+7*c))*100,1)/700}}for(let e=0;e<44;e+=2)for(let t=0;t<n.length;t++){[b,y]=n[t];var y,b,w=parseInt(.5*T*y),x=parseInt((b+e)*T*a);for(let t=0;t<.1*T;t++)r[t+x]+=q[t+w]}return t}function k(e){return()=>{var t=v.createBufferSource();t.buffer=e,t.connect(v.destination),t.start()}}function G(t){E([g,y,b,w,x][t])}function E(t){let e=n;(n=v.createBufferSource()).buffer=t,n.loop=!0,n.connect(a?S:R),n.start(),setTimeout(()=>{e?.stop()},700),S.gain.setTargetAtTime(a?1:0,v.currentTime,.3),R.gain.setTargetAtTime(a?0:1,v.currentTime,1),a=!a}a0(17,function t(){if(!v){r0(17,t);{v=new(window.AudioContext||window.webkitAudioContext),T=v.sampleRate,r=P(.2,t=>.03*K(t/(.3-220*Math.exp(-t/500)))),o=P(.2,t=>.05*(.3*A(t/(20+t/150))+Math.random())),i=P(.5,t=>.05*(.3*U(t/(120+t/250))+Math.random())*(.5*U(t/600)+.5)),h=P(.04,t=>.015*A(t/(14+t/100))),s=P(.1,t=>.008*U(t/(20+150*Math.exp(-t/1600)))),f=P(.3,t=>.03*(A(t/(14+t*t/1e6))+Math.random()/2)),l=P(.3,t=>.02*A(t/(200-t/30))),u=P(.4,t=>.01*U(t/(20+t/100)+Math.random())),c=P(.04,t=>.02*K(t/3)),d=P(2,t=>.04*(.5*U(t/800)+.5)*K(t/130)),M=P(2,t=>.02*U(t/(1+t/900))),p=P(.6,t=>.03*A(t/(30+A(t/900)+t/1300))),V=v.createBuffer(1,T,T),q=V.getChannelData(0);var n=.1*T;for(let t=0;t<n;t++)q[t]+=.01*(A(t/(70+t/300))+Math.random()/3)*(1-t/n),q[parseInt(.5*T)+t]+=.005*Math.random()*(1-t/n);let e=(m=v.createBuffer(1,3*T,T)).getChannelData(0);for(let t=0;t<3*T;t++){var a=t/T;e[t]=N(t/120,10+10*A(t/1e4+a*a*a*4))*a/100}g=J(Z(1,[0,2,3,5,7,12]),1.6),y=J(Z(2,[0,2,3,5,7,8,11,12]),.5),b=J(Z(3,[0,2,3,7,8,12]),.9),w=J(Z(4,[0,2,3,7,8,12]),1.2),x=J(Z(5,[0,4,5,7,12]),.8)}a0(c0,([,,,t])=>t?0:k(r)()),a0(d0,k(o)),a0(2,k(i)),a0(3,k(h)),a0(4,k(s)),a0(5,k(f)),a0(6,k(l)),a0(7,k(u)),a0(8,k(c)),a0(9,k(c)),a0(j,k(d)),a0(11,G),a0(12,()=>{(e=v.createBufferSource()).buffer=m,e.connect(v.destination),e.start()}),a0(13,()=>e.stop()),a0(14,k(M)),a0(15,k(M)),a0(16,k(p)),(S=new GainNode(v)).connect(v.destination),(R=new GainNode(v)).connect(v.destination),E(g)}})};!async function(){new m0;let t=new $;await t.generate(),x(t),x(new t0),x(new K),a0(19,([t,e,n,a])=>{for(;0<n--;)x(new e0(t,e,400*(Math.random()-.5),300*-Math.random()-200,a))}),a0(8,t=>{s=Math.max(s+t,0)}),a0(2,t=>{u0=W(u0+-t,0,l)}),a0(15,t=>{A=t,u0=l}),a0(20,t=>{s>>=1,u0=l}),a0(7,([t,e,n])=>x(new n0(t,e,n))),a0(18,([t,e,n,a])=>x(new E(t,e,n,a))),requestAnimationFrame(q)}();</script></html>